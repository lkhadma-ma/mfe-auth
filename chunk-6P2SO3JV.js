var p=(a,n,t)=>new Promise((o,u)=>{var s=c=>{try{m(t.next(c))}catch(v){u(v)}},f=c=>{try{m(t.throw(c))}catch(v){u(v)}},m=c=>c.done?o(c.value):Promise.resolve(c.value).then(s,f);m((t=t.apply(a,n)).next())});import{inject as w}from"@angular/core";import{Router as T}from"@angular/router";import{input as k}from"@angular/core";import{output as E}from"@angular/core";import{input as U}from"@angular/core";import{output as x}from"@angular/core";import*as r from"@angular/core";var S=["*"],h=class a{clickIn=x();label=U();onClick(){this.clickIn.emit()}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=r.\u0275\u0275defineComponent({type:a,selectors:[["mfe-auth-button"]],hostAttrs:[1,"mfe-auth-w-full","mfe-auth-justify-center","mfe-auth-flex","mfe-auth-items-center"],inputs:{label:[1,"label"]},outputs:{clickIn:"clickIn"},ngContentSelectors:S,decls:4,vars:1,consts:[["type","button",1,"mfe-auth-w-full","mfe-auth-flex","mfe-auth-items-center","mfe-auth-bg-white","mfe-auth-border","mfe-auth-border-gray-300","mfe-auth-rounded-lg","mfe-auth-shadow-md","mfe-auth-px-6","mfe-auth-py-2","mfe-auth-text-sm","mfe-auth-font-medium","mfe-auth-text-gray-800","hover:mfe-auth-bg-gray-200","focus:mfe-auth-outline-none","focus:mfe-auth-ring-2","focus:mfe-auth-ring-offset-2","focus:mfe-auth-ring-gray-500","mfe-auth-justify-center",3,"click"]],template:function(t,o){t&1&&(r.\u0275\u0275projectionDef(),r.\u0275\u0275domElementStart(0,"button",0),r.\u0275\u0275domListener("click",function(){return o.onClick()}),r.\u0275\u0275projection(1),r.\u0275\u0275domElementStart(2,"span"),r.\u0275\u0275text(3),r.\u0275\u0275domElementEnd()()),t&2&&(r.\u0275\u0275advance(3),r.\u0275\u0275textInterpolate(o.label()))},encapsulation:2})};import*as l from"@angular/core";var d=class a{clickIn=E();label=k();onClick(){this.clickIn.emit()}ngOnInit(){}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=l.\u0275\u0275defineComponent({type:a,selectors:[["app-continue-with"]],hostAttrs:[1,"mfe-auth-w-full","mfe-auth-justify-center","mfe-auth-flex","mfe-auth-items-center"],inputs:{label:[1,"label"]},outputs:{clickIn:"clickIn"},decls:6,vars:1,consts:[[3,"clickIn","label"],["viewBox","0 0 48 48","xmlns","http://www.w3.org/2000/svg",1,"mfe-auth-h-6","mfe-auth-w-6","mfe-auth-mr-2"],["d","M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z","fill","#FFC107"],["d","M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z","fill","#FF3D00"],["d","M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z","fill","#4CAF50"],["d","M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z","fill","#1976D2"]],template:function(t,o){t&1&&(l.\u0275\u0275elementStart(0,"mfe-auth-button",0),l.\u0275\u0275listener("clickIn",function(){return o.onClick()}),l.\u0275\u0275namespaceSVG(),l.\u0275\u0275elementStart(1,"svg",1),l.\u0275\u0275element(2,"path",2)(3,"path",3)(4,"path",4)(5,"path",5),l.\u0275\u0275elementEnd()()),t&2&&l.\u0275\u0275property("label",o.label())},dependencies:[h],encapsulation:2})};import{input as N,output as W}from"@angular/core";import*as i from"@angular/core";function A(a,n){a&1&&(i.\u0275\u0275domElementStart(0,"span",6),i.\u0275\u0275text(1," Current "),i.\u0275\u0275domElementEnd())}var g=class a{clickIn=W();profile=N();onClick(){this.clickIn.emit()}ngOnInit(){}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=i.\u0275\u0275defineComponent({type:a,selectors:[["app-continue-with-profile"]],hostAttrs:[1,"mfe-auth-w-full","mfe-auth-justify-center","mfe-auth-flex","mfe-auth-items-center"],inputs:{profile:[1,"profile"]},outputs:{clickIn:"clickIn"},decls:10,vars:5,consts:[["type","button",1,"mfe-auth-w-full","mfe-auth-flex","mfe-auth-items-center","mfe-auth-bg-white","mfe-auth-border","mfe-auth-border-gray-300","mfe-auth-rounded-lg","mfe-auth-shadow-md","mfe-auth-px-6","mfe-auth-py-2","mfe-auth-text-sm","mfe-auth-font-medium","mfe-auth-text-gray-800","hover:mfe-auth-bg-gray-200","focus:mfe-auth-outline-none","focus:mfe-auth-ring-2","focus:mfe-auth-ring-offset-2","focus:mfe-auth-ring-gray-500","mfe-auth-justify-center","mfe-auth-relative",3,"click"],["alt","",1,"mfe-auth-h-16","mfe-auth-w-16","mfe-auth-mr-2","mfe-auth-rounded-full","object-cover",3,"src","alt"],[1,"mfe-auth-flex","mfe-auth-flex-col","mfe-auth-items-start","mfe-auth-text-left"],[1,"mfe-auth-font-bold"],[1,"mfe-auth-text-sm"],[1,"mfe-auth-text-xs"],[1,"mfe-auth-absolute","mfe-auth-top-0","mfe-auth-right-0","mfe-auth-text-xs","mfe-auth-font-semibold","mfe-auth-rounded-full","mfe-auth-px-2","mfe-auth-py-1","mfe-auth-mt-1","mfe-auth-mr-1"]],template:function(t,o){if(t&1&&(i.\u0275\u0275domElementStart(0,"button",0),i.\u0275\u0275domListener("click",function(){return o.onClick()}),i.\u0275\u0275domElement(1,"img",1),i.\u0275\u0275domElementStart(2,"div",2)(3,"span",3),i.\u0275\u0275text(4),i.\u0275\u0275domElementEnd(),i.\u0275\u0275domElementStart(5,"span",4),i.\u0275\u0275text(6),i.\u0275\u0275domElementEnd(),i.\u0275\u0275domElementStart(7,"span",5),i.\u0275\u0275text(8,"Continue with Google"),i.\u0275\u0275domElementEnd()(),i.\u0275\u0275conditionalCreate(9,A,2,0,"span",6),i.\u0275\u0275domElementEnd()),t&2){let u,s,f,m,c;i.\u0275\u0275advance(),i.\u0275\u0275domProperty("src",(u=o.profile())==null?null:u.photoURL,i.\u0275\u0275sanitizeUrl)("alt",(s=o.profile())==null?null:s.name),i.\u0275\u0275advance(3),i.\u0275\u0275textInterpolate((f=o.profile())==null?null:f.name),i.\u0275\u0275advance(2),i.\u0275\u0275textInterpolate((m=o.profile())==null?null:m.email),i.\u0275\u0275advance(3),i.\u0275\u0275conditional((c=o.profile())!=null&&c.isCurrent?9:-1)}},encapsulation:2})};import{inject as D,signal as b,effect as _}from"@angular/core";import{Auth as j,signInWithPopup as M,GoogleAuthProvider as O,signOut as P,authState as G}from"@angular/fire/auth";import*as y from"@angular/core";var C=class a{auth=D(j);user$=G(this.auth);accounts=b(this.loadAccounts());activeUser=b(this.loadActiveUser());constructor(){_(()=>this.saveAccounts(this.accounts())),_(()=>this.saveActiveUser(this.activeUser()))}loginWithGoogle(){return p(this,null,function*(){let n=new O;n.setCustomParameters({prompt:"select_account"});let o=(yield M(this.auth,n)).user,u={uid:o.uid,displayName:o.displayName,email:o.email,photoURL:o.photoURL};return this.addAccount(u),this.activeUser.set(u),o})}addAccount(n){this.accounts().some(t=>t.uid===n.uid)||this.accounts.update(t=>[...t,n])}switchAccount(n){let t=this.accounts().find(o=>o.uid===n)??null;this.activeUser.set(t)}logout(){return this.activeUser.set(null),P(this.auth)}currentUser(){return this.activeUser()}saveAccounts(n){localStorage.setItem("accounts",JSON.stringify(n))}saveActiveUser(n){localStorage.setItem("activeUser",n?JSON.stringify(n):"null")}loadAccounts(){try{return JSON.parse(localStorage.getItem("accounts")??"[]")}catch{return[]}}loadActiveUser(){try{return JSON.parse(localStorage.getItem("activeUser")??"null")}catch{return null}}static \u0275fac=function(t){return new(t||a)};static \u0275prov=y.\u0275\u0275defineInjectable({token:a,factory:a.\u0275fac,providedIn:"root"})};import*as e from"@angular/core";var B=(a,n,t,o)=>({name:a,email:n,photoURL:t,isCurrent:o});function F(a,n){if(a&1){let t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"app-continue-with-profile",3),e.\u0275\u0275listener("clickIn",function(){let u=e.\u0275\u0275restoreView(t).$implicit,s=e.\u0275\u0275nextContext(2);return e.\u0275\u0275resetView(s.switchTo(u))}),e.\u0275\u0275elementEnd()}if(a&2){let t=n.$implicit,o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("profile",e.\u0275\u0275pureFunction4(1,B,t.displayName??"",t.email??"",t.photoURL??"",o.currentUser(t)))}}function L(a,n){if(a&1&&e.\u0275\u0275repeaterCreate(0,F,1,6,"app-continue-with-profile",2,e.\u0275\u0275repeaterTrackByIndex),a&2){let t=e.\u0275\u0275nextContext();e.\u0275\u0275repeater(t.accounts())}}var I=class a{router=w(T);auth=w(C);label="Continue with Google";accounts=this.auth.accounts;ngOnInit(){this.auth.user$.subscribe(n=>{n&&(this.label="Continue with other account",this.auth.addAccount({uid:n.uid,displayName:n.displayName,email:n.email,photoURL:n.photoURL}))})}continueWithGoogle(){return p(this,null,function*(){let n=yield this.auth.loginWithGoogle();this.router.navigate(["home"])})}switchTo(n){this.auth.switchAccount(n.uid),this.router.navigate(["/"])}currentUser(n){return this.auth.currentUser()?.uid===n.uid}static \u0275fac=function(t){return new(t||a)};static \u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["btn-continue-with-google"]],hostAttrs:[1,"mfe-auth-w-full","mfe-auth-justify-center","mfe-auth-flex","mfe-auth-items-center"],decls:3,vars:2,consts:[[1,"mfe-auth-flex","mfe-auth-flex-col","mfe-auth-gap-2","mfe-auth-w-full"],[3,"clickIn","label"],[3,"profile"],[3,"clickIn","profile"]],template:function(t,o){t&1&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275conditionalCreate(1,L,2,0),e.\u0275\u0275elementStart(2,"app-continue-with",1),e.\u0275\u0275listener("clickIn",function(){return o.continueWithGoogle()}),e.\u0275\u0275elementEnd()()),t&2&&(e.\u0275\u0275advance(),e.\u0275\u0275conditional(o.accounts().length>0?1:-1),e.\u0275\u0275advance(),e.\u0275\u0275property("label",o.label))},dependencies:[d,g],encapsulation:2})};export{I as a};
